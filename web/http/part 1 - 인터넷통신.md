#  인터넷 네트워크
서버와 클라이언트의 통신은 어떻게 이루어지나?

### **인터넷 프로토콜 (IP 프로토콜)**
- 클라이언트와 서버는 각각 ip주소를 부여받아야 한다.
- 클라이언트와 서버는 각각 지정한 ip로 `패킷`을 통해 데이터를 전달한다.
- 패킷은 중간 인터넷망을 이용하는데, 인터넷망은 상당히 복잡하다. 수많은 서버(노드)를 거쳐서 지정된 ip로 전달한다. 서버(노드)들은 서로 간의 규격을 지키고 있다.

- **IP 프로토콜의 한계**
  - 비연결성 : 패킷을 받을 대상이 없어도 패킷이 전송된다. 즉, 지정한 ip가 패킷을 받지 못하는 상황이라고 하더라고 일단 패킷이 전송된다. 대상이 서비스 불능상태여도 패킷이 전송된다.
  - 비신뢰성 : 패킷이 중간 인터넷망에서 중간에 사라지거나, 순서가 보장이 되지 않을 수 있다. 
    - 패킷 소실 : 중간 인터넷망 서버(노드)가 서비스 불능이면, 패킷이 손실될 수 있다.
    - 패킷 전달 순서 : 보통 1500byte가 넘어가면 패킷을 여러개로 나눠서 보내는데, 이렇게 나눠진 패킷이 순서대로 전달 되지 않을 수 있다. 왜냐하면 패킷마다 다른 서버(노드)를 거칠 수 있기 때문이다.
  - 프로그램 구분 : 같은 ip를 사용하는 경우, 구분을 할 수 없다.

### **TCP ->  인터넷 프로토콜의 한계를 극복하고자 생겼다.**
- 선수 개념
  - 인터넷 프로토콜 스택의 4계층
    - 네트워크 인터페이스 계층 ⇢ 인터넷 계층 (IP) ⇢ 전송 계층 (TCP, UDP) ⇢ 애플리케이션 계층 (HTTP, FTP)
  - IP 프로토콜의 한계를 한개의 층을 더해서 극복하고자 했다.
  - 프로그램이 정보를 지정된 IP로 보내면, 애플리케이션 계층에서부터 네트워크 계층가지 레이어가 씌어지고 그것이 패킷화 되어 데이터로 전송된다.
    - IP 패킷 정보
    - 패킷이란? package + bucket의 합성어, 데이터 덩어리이다.
    - 출발지 IP, 목적지 IP..
  - TCP/IP패킹 정보
    - 출발지 PORT, 목적지 PORT, 전송 제어, 순서, 검증정보 등.. IP 패킷 정보로만은 해결할 수 없는 여러 한계점을 해결하기 위한 추가적인 정보들이 담긴다.

- TCP의 특징
  - **TCP (Transmisson Control Protocol) : 전송 제어 프로토콜**
    - 연결 지향 : 일단 출발지 IP와 목적지 IP가 통신이 가능한 상태인지, 연결이 가능한 상태인지 확인하고 패킷을 보낸다. IP 프로토콜의 비연결성이 극복된다.
    - 데이터 전달 보증 : 만약 보낸 패킷이 중간에 소실되더라도, 출발지에서 소실에 대한 사실을 알 수 있다.
    - 순서 보장 : 패킷의 순서를 보장한다.
    - 신뢰할 수 있는 프로토콜 : 비연결성, 비신뢰성 극복 ⇢ 현재는 대부분 TCP 사용 

  - **TCP 3 way handshake (개념적으로만 연결이 된 것이고(가상연결), 물리적으로는 연결이 안된 상태)**
    - 본격적인 패킷 전송 전에, 클라이언트와 서버가 3단계로 서로 연결 확인을 한다.
    - 용어
    - SYN : 접속 요청
    - ACK : 요청 수락
    - 과정
      - 첫번째 ⇢ SYN : 클라이언트에서 서버로 먼저 연결 요청 신호를 보낸다.
      - 두번째 ⇢ SYN + ACK : 서버에서 클라이언트의 SYN을 확인하면 응답을 한다.
      - 세번째 ⇢ ACK : 서버의 응답을 받아 클라이언트도 다시 ACK 응답을 한다.
      - 연결 확인 후, 데이터 전송

  - **데이터 전달 보증**

    - 클라이언트에서 데이터를 전송했을 때, 서버에서 데이터를 잘 받았다고 응답을 해준다.

  - **패킷의 순서 보장**

    - 만약 서버에 순서가 보장된 상태로 도착한다면, 서버에서는 클라이언트로 순서대로 다시 보내라고 요청에 대한 재요청을 한다. 이게 가능한 이유는 TCP 패킷에 순서를 보장할 수 있는 정보들이 같이 들어있기 때문이다.

### UDP 
- 기능이 거의없다. 
  - 3 way handshake 도 없고, 데이터 전달보증도 안되고, 순서보장도 안되고 거의 IP프로토콜이랑 기능이 비슷하다.
- 근데 왜 쓰나?
  - TCP는 다 좋은데, 3 way handshake 하는 과정에서 속도나 최적화가 어렵다. 그래서 TCP 보다 더 빠른 속도나 성능을 원한다면 UDP에서 개발자가 원하는 것을 추가로 얹혀서 사용하면 된다. **최근에는 UDP가 더 뜨고 있다.** 



### Port 
한번에 여러개의 서버와 통신을 해야하면 어떻게 해야할까? IP만 가지고 하려다보면 각 서버에 보내는 요청과 응답에 대한 출발지와 목적리를 특정 할 수 없다. 그래서 하나의 IP에서 Port로 구분한다. 같은 IP내에서 프로세스를 구분하는 것을 Port라고 한다. 

- 할당 가능한 포트 
  - 0 ~ 65535
  - 잘 알려진 포트이므로 사용하지 않은 것이 좋음: 0 ~ 1023
  - FTP: 20, 21
  - TELNET 23
  - HTTP 80
  - HTTPS 443



### DNS (Domain Name System)
IP는 기억하기 어렵다. IP는 변경될 수 있다. 
- 전화번호부와 같다. 
- 도메인명을 IP로 전환한다.
- DNS server란?(nameserver)
  - 도메인명과 IP가 보관되고 있는 서버, 클라이언트가 도메인으로 요청을 했을 때 도메인 서버에서 해당 도메인에 매칭되는 IP를 찾아 응답해준다.









